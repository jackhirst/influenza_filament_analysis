# influenza_filament_analysis
Scripts designed to take confocal images of filamentous virions and analyse them in useful ways.

BatchFilamentAnalysis.ijm will analyse 8-bit single-channel images in FIJI and generate a csv file with the lengths of all filamentous particles for each csv. It assumes nothing will interrupt opening the czi files = i.e. BioFormats is importing in the windowless format. The later analysis scripts require a csv file for each experiment with a column of filament lengths for each condition, so the individual csv files generated by this macro will have to be combined

Eccentricity Analysis.ijm will process each czi file in a set of folders, fitting ellipses to each filament and saving the major and minor axes of these fitted ellipses. At present, the csv files generated have to be combined manually before further analysis.

CSVcombiner.py can be used to combine all individual csv files for an experimental repeat. Use it to navigate to the experimental repeat folder and hit "p" to process the folder and combine all the csv files. Folders should be structured as follows:
->Experimental repeat (e.g. Pipetting repeat 2)
    -> Condition 1 (e.g. 0 pipette actions)
        -> CSV files from each micrograph

AllFilamentAnalysisPlots.py will take the csvs it is given and produce violin plots showing the distribution of filament lengths, bar or scatter plots showing changes in filament concentration, histograms showing the distribution of lengths and concentrations relative to the mean, or generic bar/scatter plots for other types of data.

FilamentAnalysisFunctions.py contains all the functions used by AllFilamentAnalysisPLots.py

Major-minor axis plot.R takes CSV files containing experimental conditions and major and minor axes of the ellipses fitted to filaments and plots the major axis against the minor for each condition.

All micrographs used in the analysis are available at http://researchdata.gla.ac.uk/876/.
Further details regarding the experiments can be found in the bioRxiv preprint at https://www.biorxiv.org/content/10.1101/686642v1 or the final published version of the paper which should be released shortly.
